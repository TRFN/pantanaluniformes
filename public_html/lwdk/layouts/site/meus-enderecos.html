<div role="main" class="main shop">
    <section class="page-header page-header-classic">
        <div class="container">
            <div class="row">
                <div class="col p-static">
                    <h1 class="font-weight-bold appear-animation" data-title-border data-appear-animation="maskUp" data-appear-animation-delay="300">{cli_name}</h1>
                </div>
            </div>
        </div>
    </section>
    <div class="container py-4">
        <div class="row">
            <div class="col-lg-3">
                <aside class="sidebar">
                    <h5 class="font-weight-semi-bold pt-3">Menu</h5>
                    <ul class="nav nav-list flex-column">
                        <li class="nav-item"><a class="nav-link" href="/meu_perfil/">Meu Perfil</a></li>
                        <li class="nav-item"><a class="nav-link" href="/favoritos/">Favoritos</a></li>

                        <li class="nav-item"><a class="nav-link" href="/meus_enderecos/" style="color: #d44;">Meus Endereços</a></li>
                        <li class="nav-item"><a class="nav-link" href="/minhas_compras/">Minhas Compras</a></li>
						<li class="nav-item"><a class="nav-link" href="/carrinho_de_compras/">Carrinho de Compras</a></li>
						<!-- li class="nav-item"><a class="nav-link" href="/cartoes/">Cart&otilde;es de Cr&eacute;dito</a></li -->
                        <li></li>
                        <li></li>
                    </ul>
                </aside>
                <br />
                <a type="button" href="/logout/" class="btn btn-outline btn-danger mb-2">Sair</a>
            </div>
            <div class="col-lg-9">
                <div class="row">
                    <div class="col-lg-12 mb-3">
                        <div class="card mb-5">
                            <div class="card-body">
                                <h3 class="font-weight-semi-bold pt-3">MEUS ENDEREÇOS</h3>
                                <div class="row justify-content-center">
                                    <div class="form-wrapper repeater-instance">
                                        <p class="text-left">Administre e gerencie os <strong>endereços</strong> de entrega cadastrados.</p>
                                        <div data-repeater-list="">
                                            <div data-repeater-item="" class="cadastro-endereco row my-3 p-1 mb-1 content-align-justify">
                                                <div class="form-group col-12 row p-0 m-0">
                                                    <div class="col-4">
                                                        <label>
                                                            <strong>Endereço <span>Principal</span></strong>
                                                        </label>
                                                    </div>
                                                    <div class="col-14" style="text-align: right;">
                                                        <button data-repeater-delete="" class="btn btn-outline btn-danger mb-2">REMOVER &nbsp;&nbsp;<i class="fas fa-times"></i></button>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <input type="text" data-cep="" data-name="cep" class="form-control" placeholder="CEP" onkeyup="return endereco_cli.buscar_cep(this);" />
                                                </div>
                                                <div class="form-group col-md-14">
                                                    <input type="text" disabled data-name="rua" class="form-control" placeholder="Endereço" />
                                                </div>
                                                <div class="form-group col-md-3">
                                                    <input type="text" disabled data-name="numero" class="form-control" placeholder="Numero" />
                                                </div>
                                                <div class="form-group col-md-15">
                                                    <input type="text" disabled data-name="complemento" class="form-control" placeholder="Complemento" />
                                                </div>
                                                <div class="form-group col-md">
                                                    <input type="text" disabled data-name="bairro" class="form-control" placeholder="Bairro" />
                                                </div>
                                                <div class="form-group col-md">
                                                    <input type="text" disabled data-name="cidade" class="form-control" placeholder="Cidade" />
                                                </div>
                                                <div class="form-group col-md-3">
                                                    <input type="text" disabled data-name="estado" class="form-control" placeholder="Estado" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-center">
                                            <button class="btn btn-dark btn-modern text-uppercase border-radius-2 font-weight-bold text-3 py-3" onclick="endereco_cli.salvar()">Salvar Endere&ccedil;o</button>
                                            <br />
                                            <hr />
                                            <br />
                                            <br />
                                            <br />
                                            <br />
                                            <br />
                                            <button
                                                class="btn btn-dark btn-modern text-uppercase border-radius-2 font-weight-bold text-3 py-3"
                                                data-repeater-create=""
                                                onmouseenter="$(this).css({backgroundColor: '#000'});"
                                                onmouseleave="$(this).css({backgroundColor: '#566'});"
                                                style="position: absolute; right: 10px; background-color: #566; padding: 12px 16px; bottom: 10px; transition: background-color 150ms ease-in;"
                                            >
                                                <i class="fas fa-plus"></i> Adicionar outro endereço
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <section class="section section-height-3 m-0">
  <div class=" container">
    <div class="row py-5 my-4">
      <div class="col-sm-10 col-md-9 col-lg-4 text-center mb-5 mb-lg-0">
        <h2 class="text-4 line-height-1 mt-4 mb-4 text-color-light">PORTAL</h2>
        <ul class="list list-unstyled mb-0">
            <li class="font-weight-light mb-1"><a href="https://shemaysrael.com/" target="_blank" class="text-decoration-none text-color-light">&nbsp; www.shemaysrael.com</a></li>
        </ul>
      </div>
      <div class="col-sm-10 col-md-9 col-lg-4 text-center mb-5 mb-lg-0">
        <h2 class="text-4 line-height-1 mt-4 mb-4 text-color-light">CONTATOS</h2>
        <ul class="list list-dark list-unstyled mb-0">
          <li class="font-weight-light mb-1"><i class="fab fa-whatsapp text-color-light"></i> <a href="https://api.whatsapp.com/send?phone=+55{whatsapp1}" target="_blank" class="text-decoration-none text-color-light">&nbsp; {whatsapp1}</a></li>
        </ul>
      </div>
      <div class="col-sm-10 col-md-9 col-lg-3 text-center">
        <h2 class="text-4 line-height-1 mt-4 mb-4 text-color-light">REDES SOCIAIS</h2>
        <ul class="social-icons mx-2 social-icons-medium mx-2 social-icons-clean-with-border mx-2 social-icons-clean-with-border-border-grey mx-2 social-icons-clean-with-border-icon-dark me-3 mb-0">
          <li class="mx-2 social-icons-instagram">
            <a href="{instagram}" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
          </li>
          <li class="mx-2 social-icons-youtube">
            <a href="{youtube}" target="_blank" title="Instagram"><i class="fab fa-youtube"></i></a>
          </li>
          <li class="mx-2 social-icons-facebook">
            <a href="{facebook}" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
          </li>
        </ul>
      </div>
    </div>
  </div></section></div>


<script lwdk-addons>
	if(typeof endereco_cli === "undefined"){
		const endereco_cli = window.endereco_cli = new Object();
	}

	LWDKExec(()=>One(".repeater-instance").repeater({
	   initEmpty: !1,
	   isFirstItemUndeletable: true,
	   show: function (e){
	       $(this).slideDown();
	       $(this).find('button').removeClass("d-none");
		   $(this).find('label>strong>span').text("Adicional " + String($(".cadastro-endereco").length-1));
	   },
	   hide: function (e) {
	       $(this).slideUp(e);
	   }
	}));

	LWDKExec(()=>{
		endereco_cli.buscar_cep = (function(obj){
			cep = obj.value.split(/[^0-9]/).join('');

			if(cep.length > 8){
				$(obj).addClass("is-invalid");

				$(obj).closest(".cadastro-endereco").find('[data-name="rua"]').val('');
				$(obj).closest(".cadastro-endereco").find('[data-name="bairro"]').val('');
				$(obj).closest(".cadastro-endereco").find('[data-name="complemento"]').val('').prop("disabled",true);
				$(obj).closest(".cadastro-endereco").find('[data-name="cidade"]').val('');
				$(obj).closest(".cadastro-endereco").find('[data-name="estado"]').val('');
				$(obj).closest(".cadastro-endereco").find('[data-name="numero"]').val('').prop("disabled",true);
			} else if(cep.length == 8){
				swal.fire({
					title: '',
					text: 'Buscando cep, aguarde...',
					showCancelButton: false,
					showConfirmButton: false
				});

				$.get(`//viacep.com.br/ws/${cep}/json/`, function(data){
					if(typeof data.erro == "boolean" && data.erro){
						$(obj).addClass("is-invalid");
						$(obj).closest(".cadastro-endereco").find('[data-name="rua"]').val('');
						$(obj).closest(".cadastro-endereco").find('[data-name="bairro"]').val('');
						$(obj).closest(".cadastro-endereco").find('[data-name="complemento"]').val('').prop("disabled",true);
						$(obj).closest(".cadastro-endereco").find('[data-name="cidade"]').val('');
						$(obj).closest(".cadastro-endereco").find('[data-name="estado"]').val('');
						$(obj).closest(".cadastro-endereco").find('[data-name="numero"]').val('').prop("disabled",true);
						swal.fire("","Cep incorreto.","error");
					} else {
						$(obj).removeClass("is-invalid");
						$(obj).val(data.cep);
						$(obj).closest(".cadastro-endereco").find('[data-name="rua"]').val(data.logradouro);
						$(obj).closest(".cadastro-endereco").find('[data-name="bairro"]').val(data.bairro);
						$(obj).closest(".cadastro-endereco").find('[data-name="complemento"]').val(data.complemento).prop("disabled",false);
						$(obj).closest(".cadastro-endereco").find('[data-name="cidade"]').val(data.localidade.toUpperCase());
						$(obj).closest(".cadastro-endereco").find('[data-name="estado"]').val(data.uf.toUpperCase());
						$(obj).closest(".cadastro-endereco").find('[data-name="numero"]').prop("disabled",false);
						swal.close();
					}
				});
			} else {
				$(obj).removeClass("is-invalid");
			}
			return true;
		});
		endereco_cli.get = (
			() => MapTranslate(MapEl(".cadastro-endereco", function(){ return MapEl($(this).find("input"), function(){return (this.value);}, false, false).join("|")}, false, false),MapEl(".cadastro-endereco:first input", function(){ return $(this).data("name"); }))
		);
		endereco_cli.set = ((data) => {
			first = true;
			for(var e of data){
				if(!first){
					$("[data-repeater-create]")[0].click();
				}
				first=false;
				for(let a in e){
					$(".cadastro-endereco:last").find('[data-name="' + a + '"]').val(e[a]).prop("disabled", !/(cep|numero|complemento)/.test(a));
				}
			}
		});
		endereco_cli.salvar = (() => {
			let dados = endereco_cli.get();

			if(dados[0].rua.length == 0 || dados[0].cep.length !== 9){
				return swal.fire('','O endere&ccedil;o principal est&aacute; incorreto.', "error").then(()=>setTimeout(()=>{
					$(".cadastro-endereco:first input:first").addClass("is-invalid").focus()[0].click();
					$(".back-to-top")[0].click();
				}, 800));
			}

			if(dados[0].numero.length == 0){
				return swal.fire('','Especifique uma numera&ccedil;&atilde;o', "warning").then(()=>setTimeout(()=>{
					$(".cadastro-endereco:first input[data-name=\"numero\"]").addClass("is-invalid").keyup(()=>{$(".cadastro-endereco:first input[data-name=\"numero\"]").removeClass("is-invalid")}).focus()[0].click();
					$(".back-to-top")[0].click();
				}, 800));
			}

			for (var i = 1; i < dados.length; i++) {
				if(dados[i].rua.length == 0 || dados[i].cep.length !== 9){
					dados.splice(i,1);
				} else {
					if(dados[i].numero.length == 0){
						return swal.fire('','Especifique uma numera&ccedil;&atilde;o', "warning").then(()=>setTimeout(()=>{
							$(".cadastro-endereco:eq(" + String(i) + ") input[data-name=\"numero\"]").addClass("is-invalid").keyup(()=>{$(".cadastro-endereco:first input[data-name=\"numero\"]").removeClass("is-invalid")}).focus()[0].click();
						}, 800));
					}
				}
			}

			$.post("/action_mudar_endereco/", {enderecos: dados}, function(success){
				if(success){
					swal.fire("","Altera&ccedil;&otilde;es salvas com sucesso!","success").then(()=>window.location.reload());
				} else {
					swal.fire("","Houve uma falha ao salvar as altera&ccedil;&otilde;es...");
				}
			});
		});
	});

	LWDKExec(()=>endereco_cli.set({cli_enderecos}));
</script>
